#!/usr/bin/env bash

# make sure that we are on a branch that it's okay to commit to directly

set -euo pipefail # exit on any error, don't allow undefined variables, pass errors through pipes

# commits to master are allowed for some projects
if [[
  $PWD == "$HOME/.config/nvim" ||
  $PWD == "/Users/david/code/dotfiles" ||
  $PWD == "/Users/david/code/playground" ||
  $PWD == "/Users/david/code/blog" ||
  $PWD == "/Users/david/code/okcupid" ||
  $PWD == "/Users/david/Sync/bin"
]]; then
  exit 0
fi

if [[ $(git rev-parse --abbrev-ref HEAD) =~ ^(safe|master)$ ]]
then
  echo "Change your branch name, silly!"
  exit 1 # failure code
fi
